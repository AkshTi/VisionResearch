=========================================
Step 5: Regenerate with Corrupted Poses
Action-Video Mismatch Experiment - Phase 2
=========================================

Job ID: 9372327
Node: node3004
Start time: Wed Feb 18 20:14:27 EST 2026
GPU: 0,1

Python: /home/akshatat/.conda/envs/mech_interp_gpu/bin/python
Python version: Python 3.10.14

Checking GPU availability...
Wed Feb 18 20:14:30 2026       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 590.48.01              Driver Version: 590.48.01      CUDA Version: 13.1     |
+-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA L40S                    On  |   00000000:4A:00.0 Off |                    0 |
| N/A   30C    P8             32W /  350W |       0MiB /  46068MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
|   1  NVIDIA L40S                    On  |   00000000:61:00.0 Off |                    0 |
| N/A   30C    P8             33W /  350W |       0MiB /  46068MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+

+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI              PID   Type   Process name                        GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+

=========================================
Starting corrupted pose regeneration...
=========================================

============================================================
STEP 5: Regenerate videos with corrupted poses
============================================================
  Phase 1 median drift: 35.13 deg
  Corruption scales: [0.5, 1.0, 2.0]
  Runner: diffusion-forcing-transformer/_phase2_runner.py

--- Extracting GT future frames from clean baseline ---
  GT frames saved to runs/action_mismatch/phase2/gt_frames_sample_*/

============================================================
  CORRUPTION SCALE = 0.5  (~17.6 deg final)
============================================================

  [RUN] DFoT with corruption scale=0.5
    cwd: diffusion-forcing-transformer
    Expected final corruption: ~17.6 deg

  [FAILED] scale=0.5
  stderr (tail):
  noqa: F401
  File "/home/akshatat/.conda/envs/mech_interp_gpu/lib/python3.10/site-packages/torchmetrics/functional/text/bert.py", line 24, in <module>
    from torchmetrics.functional.text.helper_embedding_metric import (
  File "/home/akshatat/.conda/envs/mech_interp_gpu/lib/python3.10/site-packages/torchmetrics/functional/text/helper_embedding_metric.py", line 26, in <module>
    from transformers import AutoModelForMaskedLM, AutoTokenizer, PreTrainedModel, PreTrainedTokenizerBase
  File "/home/akshatat/.conda/envs/mech_interp_gpu/lib/python3.10/site-packages/transformers/utils/import_utils.py", line 2044, in __getattr__
    module = self._get_module(self._class_to_module[name])
  File "/home/akshatat/.conda/envs/mech_interp_gpu/lib/python3.10/site-packages/transformers/utils/import_utils.py", line 2238, in _get_module
    raise e
  File "/home/akshatat/.conda/envs/mech_interp_gpu/lib/python3.10/site-packages/transformers/utils/import_utils.py", line 2236, in _get_module
    return importlib.import_module("." + module_name, self.__name__)
  File "/home/akshatat/.conda/envs/mech_interp_gpu/lib/python3.10/importlib/__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "/home/akshatat/.conda/envs/mech_interp_gpu/lib/python3.10/site-packages/transformers/models/auto/modeling_auto.py", line 21, in <module>
    from .auto_factory import (
  File "/home/akshatat/.conda/envs/mech_interp_gpu/lib/python3.10/site-packages/transformers/models/auto/auto_factory.py", line 43, in <module>
    from ...generation import GenerationMixin
  File "/home/akshatat/.conda/envs/mech_interp_gpu/lib/python3.10/site-packages/transformers/utils/import_utils.py", line 2044, in __getattr__
    module = self._get_module(self._class_to_module[name])
  File "/home/akshatat/.conda/envs/mech_interp_gpu/lib/python3.10/site-packages/transformers/utils/import_utils.py", line 2238, in _get_module
    raise e
  File "/home/akshatat/.conda/envs/mech_interp_gpu/lib/python3.10/site-packages/transformers/utils/import_utils.py", line 2236, in _get_module
    return importlib.import_module("." + module_name, self.__name__)
  File "/home/akshatat/.conda/envs/mech_interp_gpu/lib/python3.10/importlib/__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "/home/akshatat/.conda/envs/mech_interp_gpu/lib/python3.10/site-packages/transformers/generation/utils.py", line 44, in <module>
    from ..masking_utils import create_masks_for_generate
  File "/home/akshatat/.conda/envs/mech_interp_gpu/lib/python3.10/site-packages/transformers/masking_utils.py", line 40, in <module>
    from torch._dynamo._trace_wrapped_higher_order_op import TransformGetItemToIndex
ImportError: cannot import name 'TransformGetItemToIndex' from 'torch._dynamo._trace_wrapped_higher_order_op' (/home/akshatat/.conda/envs/mech_interp_gpu/lib/python3.10/site-packages/torch/_dynamo/_trace_wrapped_higher_order_op.py)

  stdout (tail):
 
  Skipping frame extraction for scale=0.5

============================================================
  CORRUPTION SCALE = 1.0  (~35.1 deg final)
============================================================

  [RUN] DFoT with corruption scale=1.0
    cwd: diffusion-forcing-transformer
    Expected final corruption: ~35.1 deg

  [FAILED] scale=1.0
  stderr (tail):
  noqa: F401
  File "/home/akshatat/.conda/envs/mech_interp_gpu/lib/python3.10/site-packages/torchmetrics/functional/text/bert.py", line 24, in <module>
    from torchmetrics.functional.text.helper_embedding_metric import (
  File "/home/akshatat/.conda/envs/mech_interp_gpu/lib/python3.10/site-packages/torchmetrics/functional/text/helper_embedding_metric.py", line 26, in <module>
    from transformers import AutoModelForMaskedLM, AutoTokenizer, PreTrainedModel, PreTrainedTokenizerBase
  File "/home/akshatat/.conda/envs/mech_interp_gpu/lib/python3.10/site-packages/transformers/utils/import_utils.py", line 2044, in __getattr__
    module = self._get_module(self._class_to_module[name])
  File "/home/akshatat/.conda/envs/mech_interp_gpu/lib/python3.10/site-packages/transformers/utils/import_utils.py", line 2238, in _get_module
    raise e
  File "/home/akshatat/.conda/envs/mech_interp_gpu/lib/python3.10/site-packages/transformers/utils/import_utils.py", line 2236, in _get_module
    return importlib.import_module("." + module_name, self.__name__)
  File "/home/akshatat/.conda/envs/mech_interp_gpu/lib/python3.10/importlib/__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "/home/akshatat/.conda/envs/mech_interp_gpu/lib/python3.10/site-packages/transformers/models/auto/modeling_auto.py", line 21, in <module>
    from .auto_factory import (
  File "/home/akshatat/.conda/envs/mech_interp_gpu/lib/python3.10/site-packages/transformers/models/auto/auto_factory.py", line 43, in <module>
    from ...generation import GenerationMixin
  File "/home/akshatat/.conda/envs/mech_interp_gpu/lib/python3.10/site-packages/transformers/utils/import_utils.py", line 2044, in __getattr__
    module = self._get_module(self._class_to_module[name])
  File "/home/akshatat/.conda/envs/mech_interp_gpu/lib/python3.10/site-packages/transformers/utils/import_utils.py", line 2238, in _get_module
    raise e
  File "/home/akshatat/.conda/envs/mech_interp_gpu/lib/python3.10/site-packages/transformers/utils/import_utils.py", line 2236, in _get_module
    return importlib.import_module("." + module_name, self.__name__)
  File "/home/akshatat/.conda/envs/mech_interp_gpu/lib/python3.10/importlib/__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "/home/akshatat/.conda/envs/mech_interp_gpu/lib/python3.10/site-packages/transformers/generation/utils.py", line 44, in <module>
    from ..masking_utils import create_masks_for_generate
  File "/home/akshatat/.conda/envs/mech_interp_gpu/lib/python3.10/site-packages/transformers/masking_utils.py", line 40, in <module>
    from torch._dynamo._trace_wrapped_higher_order_op import TransformGetItemToIndex
ImportError: cannot import name 'TransformGetItemToIndex' from 'torch._dynamo._trace_wrapped_higher_order_op' (/home/akshatat/.conda/envs/mech_interp_gpu/lib/python3.10/site-packages/torch/_dynamo/_trace_wrapped_higher_order_op.py)

  stdout (tail):
 
  Skipping frame extraction for scale=1.0

============================================================
  CORRUPTION SCALE = 2.0  (~70.3 deg final)
============================================================

  [RUN] DFoT with corruption scale=2.0
    cwd: diffusion-forcing-transformer
    Expected final corruption: ~70.3 deg

  [FAILED] scale=2.0
  stderr (tail):
  noqa: F401
  File "/home/akshatat/.conda/envs/mech_interp_gpu/lib/python3.10/site-packages/torchmetrics/functional/text/bert.py", line 24, in <module>
    from torchmetrics.functional.text.helper_embedding_metric import (
  File "/home/akshatat/.conda/envs/mech_interp_gpu/lib/python3.10/site-packages/torchmetrics/functional/text/helper_embedding_metric.py", line 26, in <module>
    from transformers import AutoModelForMaskedLM, AutoTokenizer, PreTrainedModel, PreTrainedTokenizerBase
  File "/home/akshatat/.conda/envs/mech_interp_gpu/lib/python3.10/site-packages/transformers/utils/import_utils.py", line 2044, in __getattr__
    module = self._get_module(self._class_to_module[name])
  File "/home/akshatat/.conda/envs/mech_interp_gpu/lib/python3.10/site-packages/transformers/utils/import_utils.py", line 2238, in _get_module
    raise e
  File "/home/akshatat/.conda/envs/mech_interp_gpu/lib/python3.10/site-packages/transformers/utils/import_utils.py", line 2236, in _get_module
    return importlib.import_module("." + module_name, self.__name__)
  File "/home/akshatat/.conda/envs/mech_interp_gpu/lib/python3.10/importlib/__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "/home/akshatat/.conda/envs/mech_interp_gpu/lib/python3.10/site-packages/transformers/models/auto/modeling_auto.py", line 21, in <module>
    from .auto_factory import (
  File "/home/akshatat/.conda/envs/mech_interp_gpu/lib/python3.10/site-packages/transformers/models/auto/auto_factory.py", line 43, in <module>
    from ...generation import GenerationMixin
  File "/home/akshatat/.conda/envs/mech_interp_gpu/lib/python3.10/site-packages/transformers/utils/import_utils.py", line 2044, in __getattr__
    module = self._get_module(self._class_to_module[name])
  File "/home/akshatat/.conda/envs/mech_interp_gpu/lib/python3.10/site-packages/transformers/utils/import_utils.py", line 2238, in _get_module
    raise e
  File "/home/akshatat/.conda/envs/mech_interp_gpu/lib/python3.10/site-packages/transformers/utils/import_utils.py", line 2236, in _get_module
    return importlib.import_module("." + module_name, self.__name__)
  File "/home/akshatat/.conda/envs/mech_interp_gpu/lib/python3.10/importlib/__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "/home/akshatat/.conda/envs/mech_interp_gpu/lib/python3.10/site-packages/transformers/generation/utils.py", line 44, in <module>
    from ..masking_utils import create_masks_for_generate
  File "/home/akshatat/.conda/envs/mech_interp_gpu/lib/python3.10/site-packages/transformers/masking_utils.py", line 40, in <module>
    from torch._dynamo._trace_wrapped_higher_order_op import TransformGetItemToIndex
ImportError: cannot import name 'TransformGetItemToIndex' from 'torch._dynamo._trace_wrapped_higher_order_op' (/home/akshatat/.conda/envs/mech_interp_gpu/lib/python3.10/site-packages/torch/_dynamo/_trace_wrapped_higher_order_op.py)

  stdout (tail):
 
  Skipping frame extraction for scale=2.0

  Step 5 complete!
  Scales generated: []
  Next: run step6_evaluate_phase2.py

=========================================
Step 5 Complete
=========================================
Exit code: 0
End time: Wed Feb 18 20:15:11 EST 2026

Phase 2 generated frames:
runs/action_mismatch/phase2/gt_frames_sample_0000/frame_0000.png
runs/action_mismatch/phase2/gt_frames_sample_0001/frame_0000.png
runs/action_mismatch/phase2/gt_frames_sample_0002/frame_0000.png
runs/action_mismatch/phase2/gt_frames_sample_0003/frame_0000.png
runs/action_mismatch/phase2/gt_frames_sample_0004/frame_0000.png
