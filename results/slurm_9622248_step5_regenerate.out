=========================================
Step 5: Regenerate with Corrupted Poses
Action-Video Mismatch Experiment - Phase 2
=========================================

Job ID: 9622248
Node: node3204
Start time: Tue Feb 24 12:00:15 EST 2026
GPU: 0

Python: /home/akshatat/.conda/envs/mech_interp_gpu/bin/python
Python version: Python 3.10.14

Checking GPU availability...
Tue Feb 24 12:00:19 2026       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 590.48.01              Driver Version: 590.48.01      CUDA Version: 13.1     |
+-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA L40S                    On  |   00000000:CA:00.0 Off |                    0 |
| N/A   29C    P8             33W /  350W |       0MiB /  46068MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+

+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI              PID   Type   Process name                        GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+

=========================================
Starting corrupted pose regeneration...
=========================================

============================================================
STEP 5: Regenerate videos with corrupted poses
============================================================
  Phase 1 median drift: 0.30 deg
  Corruption scales: [10.0, 50.0, 100.0]
  Runner: diffusion-forcing-transformer/_phase2_runner.py

--- Extracting GT future frames from clean baseline ---
  GT frames saved to runs/action_mismatch/phase2/gt_frames_sample_*/

============================================================
  CORRUPTION SCALE = 10.0  (~3.0 deg final)
============================================================

  [RUN] DFoT with corruption scale=10.0
    cwd: diffusion-forcing-transformer
    Expected final corruption: ~3.0 deg

  [FAILED] scale=10.0
  stderr (tail):
 on_loop.py", line 153, in run
    return self.on_run_end()
  File "/home/akshatat/.conda/envs/mech_interp_gpu/lib/python3.10/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 296, in on_run_end
    self._on_evaluation_epoch_end()
  File "/home/akshatat/.conda/envs/mech_interp_gpu/lib/python3.10/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 381, in _on_evaluation_epoch_end
    trainer._logger_connector.on_epoch_end()
  File "/home/akshatat/.conda/envs/mech_interp_gpu/lib/python3.10/site-packages/lightning/pytorch/trainer/connectors/logger_connector/logger_connector.py", line 205, in on_epoch_end
    metrics = self.metrics
  File "/home/akshatat/.conda/envs/mech_interp_gpu/lib/python3.10/site-packages/lightning/pytorch/trainer/connectors/logger_connector/logger_connector.py", line 244, in metrics
    return self.trainer._results.metrics(on_step)
  File "/home/akshatat/.conda/envs/mech_interp_gpu/lib/python3.10/site-packages/lightning/pytorch/trainer/connectors/logger_connector/result.py", line 475, in metrics
    value = self._get_cache(result_metric, on_step)
  File "/home/akshatat/.conda/envs/mech_interp_gpu/lib/python3.10/site-packages/lightning/pytorch/trainer/connectors/logger_connector/result.py", line 439, in _get_cache
    result_metric.compute()
  File "/home/akshatat/.conda/envs/mech_interp_gpu/lib/python3.10/site-packages/lightning/pytorch/trainer/connectors/logger_connector/result.py", line 288, in wrapped_func
    self._computed = compute(*args, **kwargs)
  File "/home/akshatat/.conda/envs/mech_interp_gpu/lib/python3.10/site-packages/lightning/pytorch/trainer/connectors/logger_connector/result.py", line 253, in compute
    return self.value.compute()
  File "/home/akshatat/.conda/envs/mech_interp_gpu/lib/python3.10/site-packages/torchmetrics/metric.py", line 532, in wrapped_func
    value = compute(*args, **kwargs)
  File "/home/akshatat/.conda/envs/mech_interp_gpu/lib/python3.10/site-packages/torchmetrics/image/fid.py", line 288, in compute
    return _compute_fid(mean_real.squeeze(0), cov_real, mean_fake.squeeze(0), cov_fake).to(self.orig_dtype)
  File "/home/akshatat/.conda/envs/mech_interp_gpu/lib/python3.10/site-packages/torchmetrics/image/fid.py", line 116, in _compute_fid
    covmean = sqrtm(sigma1.mm(sigma2))
  File "/home/akshatat/.conda/envs/mech_interp_gpu/lib/python3.10/site-packages/torch/autograd/function.py", line 575, in apply
    return super().apply(*args, **kwargs)  # type: ignore[misc]
  File "/home/akshatat/.conda/envs/mech_interp_gpu/lib/python3.10/site-packages/torchmetrics/image/fid.py", line 71, in forward
    m = input_data.detach().cpu().numpy().astype(np.float_)
  File "/home/akshatat/.conda/envs/mech_interp_gpu/lib/python3.10/site-packages/numpy/__init__.py", line 400, in __getattr__
    raise AttributeError(
AttributeError: `np.float_` was removed in the NumPy 2.0 release. Use `np.float64` instead.

Set the environment variable HYDRA_FULL_ERROR=1 for a complete stack trace.

  stdout (tail):
 [Phase2] Patch applied (scale=10.0)
[36mOutputs will be saved to:[39m /orcd/home/002/akshatat/VisionResearch/diffusion-forcing-transformer/outputs/2026-02-24/12-00-35
[36mExecuting task:[39m validation out of ['validation']
[36mtest: 425 / 500 videos will be used after filtering out videos shorter than 221 frames[39m
Validation ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ 5/5 0:01:46 ‚Ä¢ 0:00:00 0.05it/s 
[1;34mwandb[0m: 
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync /orcd/home/002/akshatat/VisionResearch/diffusion-forcing-transformer/outputs/2026-02-24/12-00-35/wandb/offline-run-20260224_120041-3b1mjvpz[0m
[1;34mwandb[0m: Find logs at: [1;35moutputs/2026-02-24/12-00-35/wandb/offline-run-20260224_120041-3b1mjvpz/logs[0m

  Skipping frame extraction for scale=10.0

============================================================
  CORRUPTION SCALE = 50.0  (~15.0 deg final)
============================================================

  [RUN] DFoT with corruption scale=50.0
    cwd: diffusion-forcing-transformer
    Expected final corruption: ~15.0 deg

  [FAILED] scale=50.0
  stderr (tail):
 on_loop.py", line 153, in run
    return self.on_run_end()
  File "/home/akshatat/.conda/envs/mech_interp_gpu/lib/python3.10/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 296, in on_run_end
    self._on_evaluation_epoch_end()
  File "/home/akshatat/.conda/envs/mech_interp_gpu/lib/python3.10/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 381, in _on_evaluation_epoch_end
    trainer._logger_connector.on_epoch_end()
  File "/home/akshatat/.conda/envs/mech_interp_gpu/lib/python3.10/site-packages/lightning/pytorch/trainer/connectors/logger_connector/logger_connector.py", line 205, in on_epoch_end
    metrics = self.metrics
  File "/home/akshatat/.conda/envs/mech_interp_gpu/lib/python3.10/site-packages/lightning/pytorch/trainer/connectors/logger_connector/logger_connector.py", line 244, in metrics
    return self.trainer._results.metrics(on_step)
  File "/home/akshatat/.conda/envs/mech_interp_gpu/lib/python3.10/site-packages/lightning/pytorch/trainer/connectors/logger_connector/result.py", line 475, in metrics
    value = self._get_cache(result_metric, on_step)
  File "/home/akshatat/.conda/envs/mech_interp_gpu/lib/python3.10/site-packages/lightning/pytorch/trainer/connectors/logger_connector/result.py", line 439, in _get_cache
    result_metric.compute()
  File "/home/akshatat/.conda/envs/mech_interp_gpu/lib/python3.10/site-packages/lightning/pytorch/trainer/connectors/logger_connector/result.py", line 288, in wrapped_func
    self._computed = compute(*args, **kwargs)
  File "/home/akshatat/.conda/envs/mech_interp_gpu/lib/python3.10/site-packages/lightning/pytorch/trainer/connectors/logger_connector/result.py", line 253, in compute
    return self.value.compute()
  File "/home/akshatat/.conda/envs/mech_interp_gpu/lib/python3.10/site-packages/torchmetrics/metric.py", line 532, in wrapped_func
    value = compute(*args, **kwargs)
  File "/home/akshatat/.conda/envs/mech_interp_gpu/lib/python3.10/site-packages/torchmetrics/image/fid.py", line 288, in compute
    return _compute_fid(mean_real.squeeze(0), cov_real, mean_fake.squeeze(0), cov_fake).to(self.orig_dtype)
  File "/home/akshatat/.conda/envs/mech_interp_gpu/lib/python3.10/site-packages/torchmetrics/image/fid.py", line 116, in _compute_fid
    covmean = sqrtm(sigma1.mm(sigma2))
  File "/home/akshatat/.conda/envs/mech_interp_gpu/lib/python3.10/site-packages/torch/autograd/function.py", line 575, in apply
    return super().apply(*args, **kwargs)  # type: ignore[misc]
  File "/home/akshatat/.conda/envs/mech_interp_gpu/lib/python3.10/site-packages/torchmetrics/image/fid.py", line 71, in forward
    m = input_data.detach().cpu().numpy().astype(np.float_)
  File "/home/akshatat/.conda/envs/mech_interp_gpu/lib/python3.10/site-packages/numpy/__init__.py", line 400, in __getattr__
    raise AttributeError(
AttributeError: `np.float_` was removed in the NumPy 2.0 release. Use `np.float64` instead.

Set the environment variable HYDRA_FULL_ERROR=1 for a complete stack trace.

  stdout (tail):
 [Phase2] Patch applied (scale=50.0)
[36mOutputs will be saved to:[39m /orcd/home/002/akshatat/VisionResearch/diffusion-forcing-transformer/outputs/2026-02-24/12-02-44
[36mExecuting task:[39m validation out of ['validation']
[36mtest: 425 / 500 videos will be used after filtering out videos shorter than 221 frames[39m
Validation ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ 5/5 0:01:44 ‚Ä¢ 0:00:00 0.05it/s 
[1;34mwandb[0m: 
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync /orcd/home/002/akshatat/VisionResearch/diffusion-forcing-transformer/outputs/2026-02-24/12-02-44/wandb/offline-run-20260224_120249-ft3raxwi[0m
[1;34mwandb[0m: Find logs at: [1;35moutputs/2026-02-24/12-02-44/wandb/offline-run-20260224_120249-ft3raxwi/logs[0m

  Skipping frame extraction for scale=50.0

============================================================
  CORRUPTION SCALE = 100.0  (~30.0 deg final)
============================================================

  [RUN] DFoT with corruption scale=100.0
    cwd: diffusion-forcing-transformer
    Expected final corruption: ~30.0 deg

  [FAILED] scale=100.0
  stderr (tail):
 on_loop.py", line 153, in run
    return self.on_run_end()
  File "/home/akshatat/.conda/envs/mech_interp_gpu/lib/python3.10/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 296, in on_run_end
    self._on_evaluation_epoch_end()
  File "/home/akshatat/.conda/envs/mech_interp_gpu/lib/python3.10/site-packages/lightning/pytorch/loops/evaluation_loop.py", line 381, in _on_evaluation_epoch_end
    trainer._logger_connector.on_epoch_end()
  File "/home/akshatat/.conda/envs/mech_interp_gpu/lib/python3.10/site-packages/lightning/pytorch/trainer/connectors/logger_connector/logger_connector.py", line 205, in on_epoch_end
    metrics = self.metrics
  File "/home/akshatat/.conda/envs/mech_interp_gpu/lib/python3.10/site-packages/lightning/pytorch/trainer/connectors/logger_connector/logger_connector.py", line 244, in metrics
    return self.trainer._results.metrics(on_step)
  File "/home/akshatat/.conda/envs/mech_interp_gpu/lib/python3.10/site-packages/lightning/pytorch/trainer/connectors/logger_connector/result.py", line 475, in metrics
    value = self._get_cache(result_metric, on_step)
  File "/home/akshatat/.conda/envs/mech_interp_gpu/lib/python3.10/site-packages/lightning/pytorch/trainer/connectors/logger_connector/result.py", line 439, in _get_cache
    result_metric.compute()
  File "/home/akshatat/.conda/envs/mech_interp_gpu/lib/python3.10/site-packages/lightning/pytorch/trainer/connectors/logger_connector/result.py", line 288, in wrapped_func
    self._computed = compute(*args, **kwargs)
  File "/home/akshatat/.conda/envs/mech_interp_gpu/lib/python3.10/site-packages/lightning/pytorch/trainer/connectors/logger_connector/result.py", line 253, in compute
    return self.value.compute()
  File "/home/akshatat/.conda/envs/mech_interp_gpu/lib/python3.10/site-packages/torchmetrics/metric.py", line 532, in wrapped_func
    value = compute(*args, **kwargs)
  File "/home/akshatat/.conda/envs/mech_interp_gpu/lib/python3.10/site-packages/torchmetrics/image/fid.py", line 288, in compute
    return _compute_fid(mean_real.squeeze(0), cov_real, mean_fake.squeeze(0), cov_fake).to(self.orig_dtype)
  File "/home/akshatat/.conda/envs/mech_interp_gpu/lib/python3.10/site-packages/torchmetrics/image/fid.py", line 116, in _compute_fid
    covmean = sqrtm(sigma1.mm(sigma2))
  File "/home/akshatat/.conda/envs/mech_interp_gpu/lib/python3.10/site-packages/torch/autograd/function.py", line 575, in apply
    return super().apply(*args, **kwargs)  # type: ignore[misc]
  File "/home/akshatat/.conda/envs/mech_interp_gpu/lib/python3.10/site-packages/torchmetrics/image/fid.py", line 71, in forward
    m = input_data.detach().cpu().numpy().astype(np.float_)
  File "/home/akshatat/.conda/envs/mech_interp_gpu/lib/python3.10/site-packages/numpy/__init__.py", line 400, in __getattr__
    raise AttributeError(
AttributeError: `np.float_` was removed in the NumPy 2.0 release. Use `np.float64` instead.

Set the environment variable HYDRA_FULL_ERROR=1 for a complete stack trace.

  stdout (tail):
 [Phase2] Patch applied (scale=100.0)
[36mOutputs will be saved to:[39m /orcd/home/002/akshatat/VisionResearch/diffusion-forcing-transformer/outputs/2026-02-24/12-04-48
[36mExecuting task:[39m validation out of ['validation']
[36mtest: 425 / 500 videos will be used after filtering out videos shorter than 221 frames[39m
Validation ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ 5/5 0:01:45 ‚Ä¢ 0:00:00 0.05it/s 
[1;34mwandb[0m: 
[1;34mwandb[0m: You can sync this run to the cloud by running:
[1;34mwandb[0m: [1mwandb sync /orcd/home/002/akshatat/VisionResearch/diffusion-forcing-transformer/outputs/2026-02-24/12-04-48/wandb/offline-run-20260224_120452-2spt2d4i[0m
[1;34mwandb[0m: Find logs at: [1;35moutputs/2026-02-24/12-04-48/wandb/offline-run-20260224_120452-2spt2d4i/logs[0m

  Skipping frame extraction for scale=100.0

  Step 5 complete!
  Scales generated: []
  Next: run step6_evaluate_phase2.py

=========================================
Step 5 Complete
=========================================
Exit code: 0
End time: Tue Feb 24 12:06:43 EST 2026

Phase 2 generated frames:
runs/action_mismatch/phase2/gt_frames_sample_0000/frame_0000.png
runs/action_mismatch/phase2/gt_frames_sample_0001/frame_0000.png
runs/action_mismatch/phase2/gt_frames_sample_0002/frame_0000.png
runs/action_mismatch/phase2/gt_frames_sample_0003/frame_0000.png
runs/action_mismatch/phase2/gt_frames_sample_0004/frame_0000.png
